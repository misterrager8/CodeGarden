{% set status_list=[["In Development", "#2ab04e"], ["Paused", "#66b9cc"], ["Released", "#0004ff"], ["Archived", "#ff8c00"]] %}

<!--Title Div-->
{% macro title_div(txt, class='') %}
<p class="text-center {{ class }}">{{ txt }}</p>
{% endmacro %}

<!--Button-->
{% macro button(txt, href, bg_color='black', txt_color='white') %}
<a href="{{ href }}" class="btn" style="background-color:{{ bg_color }}; color:{{ txt_color }};">{{ txt }}</a>
{% endmacro %}

<!--Tool Badge-->
{% macro tool_badge(tool) %}
<a href="{{ url_for('tool', id_=tool.id) }}"><span class="badge" style="background-color:{{ tool.color }}; color:white;">{{ tool.name }}</span></a>
{% endmacro %}

<!--Status Badge-->
{% macro status_badge(project, class='') %}
<span class="badge badge-pill font-italic {{ class }}" style="border-style: solid; border-color:{{ project.get_status()[1] }}; color:{{ project.get_status()[1] }}">{{ project.get_status()[0] }}</span>
{% endmacro %}

<!--Date Label-->
{% macro date_label(project, class='') %}
<span class="font-italic {{ class }}"><small>{{ project.get_start_date("%B %d, %Y") }}</small></span>
{% endmacro %}

<!--Project List Item-->
{% macro project_list_item(project) %}
<div class="list-group-item list-group-item-action d-flex justify-content-between border-0">
  <div>
    {{ unstyled_modal_link(project.name, 'info_project_' + project.id|string, class='font-italic lead mr-2') }}
    {% for i in project.tools %}
    {{ tool_badge(i) }}
    {% endfor %}
  </div>
  <div>
    {{ status_badge(project, class='mr-2') }}
    {{ date_label(project, class='mr-2') }}
    <a href="" data-target="#edit_project_{{ project.id }}" data-toggle="modal" class="mr-2" style="text-decoration:none">{{ edit_icon(size='20') }}</a>
    <a href="" data-target="#delete_project_{{ project.id }}" data-toggle="modal" class="mr-2" style="text-decoration:none">
      {{ delete_icon() }}
    </a>
  </div>
</div>

<!--Edit Modal-->
{% call modal('edit_project_' + project.id|string, 'Edit Project') %}
{{ edit_project_form(project) }}
{% endcall %}

<!--Delete Modal-->
{% call modal('delete_project_' + project.id|string, 'Delete Project?', class='text-center') %}
<a href="{{  url_for('delete_project', id_=project.id)  }}" class="btn btn-danger w-75">Delete</a>
{% endcall %}

<!--Info Modal-->
{% call modal('info_project_' + project.id|string, project.name, class='text-center') %}
{% for i in project.tools %}
{{ tool_badge(i) }}
{% endfor %}
<p>{{ status_badge(project, class='mt-3') }}</p>
{{ date_label(project) }}
<p class="mt-2 font-italic font-weight-bold">{{ project.descrip }}</p>
{% if project.github_url %}
<a target="_blank" href="{{ project.github_url }}">{{ github_icon(size='50') }}</a>
{% endif %}
<div class="mb-4"></div>
{% endcall %}

{% endmacro %}

<!--Tool List Item-->
{% macro tool_list_item(tool) %}
<div class="list-group-item list-group-item-action d-flex justify-content-between border-0">
  {{ unstyled_link(tool.name, href=url_for('tool', id_=tool.id)) }}
  <span class="">{{ circle_icon(tool.color) }}</span>
</div>
{% endmacro %}

<!--Brand Icon-->
{% macro brand_icon() %}
<svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="white" class="bi bi-code-slash" viewBox="0 0 16 16">
  <path d="M10.478 1.647a.5.5 0 1 0-.956-.294l-4 13a.5.5 0 0 0 .956.294l4-13zM4.854 4.146a.5.5 0 0 1 0 .708L1.707 8l3.147 3.146a.5.5 0 0 1-.708.708l-3.5-3.5a.5.5 0 0 1 0-.708l3.5-3.5a.5.5 0 0 1 .708 0zm6.292 0a.5.5 0 0 0 0 .708L14.293 8l-3.147 3.146a.5.5 0 0 0 .708.708l3.5-3.5a.5.5 0 0 0 0-.708l-3.5-3.5a.5.5 0 0 0-.708 0z"/>
</svg>
{% endmacro %}

<!--Edit Icon-->
{% macro edit_icon(size='16') %}
<svg xmlns="http://www.w3.org/2000/svg" width="{{ size }}" height="{{ size }}" fill="black" class="bi bi-pencil-square" viewBox="0 0 16 16">
  <path d="M15.502 1.94a.5.5 0 0 1 0 .706L14.459 3.69l-2-2L13.502.646a.5.5 0 0 1 .707 0l1.293 1.293zm-1.75 2.456-2-2L4.939 9.21a.5.5 0 0 0-.121.196l-.805 2.414a.25.25 0 0 0 .316.316l2.414-.805a.5.5 0 0 0 .196-.12l6.813-6.814z"/>
  <path fill-rule="evenodd" d="M1 13.5A1.5 1.5 0 0 0 2.5 15h11a1.5 1.5 0 0 0 1.5-1.5v-6a.5.5 0 0 0-1 0v6a.5.5 0 0 1-.5.5h-11a.5.5 0 0 1-.5-.5v-11a.5.5 0 0 1 .5-.5H9a.5.5 0 0 0 0-1H2.5A1.5 1.5 0 0 0 1 2.5v11z"/>
</svg>
{% endmacro %}

<!--Info Icon-->
{% macro info_icon(size='16') %}
<svg xmlns="http://www.w3.org/2000/svg" width="{{ size }}" height="{{ size }}" fill="black" class="bi bi-info-square" viewBox="0 0 16 16">
  <path d="M14 1a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1h12zM2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H2z"/>
  <path d="m8.93 6.588-2.29.287-.082.38.45.083c.294.07.352.176.288.469l-.738 3.468c-.194.897.105 1.319.808 1.319.545 0 1.178-.252 1.465-.598l.088-.416c-.2.176-.492.246-.686.246-.275 0-.375-.193-.304-.533L8.93 6.588zM9 4.5a1 1 0 1 1-2 0 1 1 0 0 1 2 0z"/>
</svg>
{% endmacro %}

<!--Delete Icon-->
{% macro delete_icon(size='16') %}
<svg xmlns="http://www.w3.org/2000/svg" width="{{ size }}" height="{{ size }}" fill="red" class="bi bi-x-lg" viewBox="0 0 16 16">
  <path d="M1.293 1.293a1 1 0 0 1 1.414 0L8 6.586l5.293-5.293a1 1 0 1 1 1.414 1.414L9.414 8l5.293 5.293a1 1 0 0 1-1.414 1.414L8 9.414l-5.293 5.293a1 1 0 0 1-1.414-1.414L6.586 8 1.293 2.707a1 1 0 0 1 0-1.414z"/>
</svg>
{% endmacro %}

<!--Circle Icon-->
{% macro circle_icon(color, size='16') %}
<svg xmlns="http://www.w3.org/2000/svg" width="{{ size }}" height="{{ size }}" fill="{{ color }}" class="bi bi-circle-fill" viewBox="0 0 16 16">
  <circle cx="8" cy="8" r="8"/>
</svg>
{% endmacro %}

<!--GitHub Icon-->
{% macro github_icon(size='16') %}
<svg xmlns="http://www.w3.org/2000/svg" width="{{ size }}" height="{{ size }}" fill="black" class="bi bi-github" viewBox="0 0 16 16">
  <path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.012 8.012 0 0 0 16 8c0-4.42-3.58-8-8-8z"/>
</svg>
{% endmacro %}

<!--Unstyled Link-->
{% macro unstyled_link(txt, class='', href='#', color='black') %}
<a href="{{ href }}" class="{{ class }}" style="text-decoration:none;color:{{ color }};">{{ txt }}</a>
{% endmacro %}

<!--Unstyled Modal Link-->
{% macro unstyled_modal_link(txt, id, class='', color='black') %}
<a href="" class="{{ class }}" style="text-decoration:none;color:{{ color }};" data-toggle="modal" data-target="#{{ id }}">{{ txt }}</a>
{% endmacro %}

<!--Add Project Form-->
{% macro add_project_form() %}
<form class="form-group" method="POST" action="{{ url_for('add_project') }}">
  <input type="text" placeholder="Name" name="name" class="form-control my-2" autocomplete="off">
  <textarea rows="10" placeholder="Description" name="descrip" class="form-control my-2" autocomplete="off"></textarea>
  <div class="btn-group-toggle border rounded m-1 p-2 text-center" data-toggle="buttons">
    <h6 class="">Status</h6>
    {% for i in status_list %}
    <label class="shadow btn btn-outline-dark">
      {{ circle_icon(i[1]) }}
      <input type="radio" name="status" value="{{ i[0] }}">
      {{ i[0] }}
    </label>
    {% endfor %}
  </div>
  <div class="btn-group-toggle border rounded p-2" data-toggle="buttons" style="flex-wrap:wrap">
    <h6 class="text-center">Tools Used</h6>
    {% for i in tools %}
    <label class="shadow btn btn-outline-success my-1">
      {{ circle_icon(i.color) }}
      <input name="tools_used" type="checkbox" value="{{ i.id }}">
      {{ i.name }}
    </label>
    {% endfor %}
  </div>
  <button type="submit" class="btn btn-success w-100 my-2">Add</button>
</form>
{% endmacro %}

<!--Edit Project Form-->
{% macro edit_project_form(project) %}
<form class="form-group" method="POST" action="{{ url_for('edit_project', id_=project.id) }}">
  <input type="text" placeholder="Name" name="name" class="form-control my-2" autocomplete="off" value="{{ project.name }}">
  <textarea rows="10" placeholder="Description" name="descrip" class="form-control my-2" autocomplete="off">{{ project.descrip }}</textarea>
  <input type="date" name="start_date" class="form-control" value="{{ project.get_start_date('%Y-%m-%d') }}">
  <div class="btn-group-toggle border rounded m-1 p-2 text-center" data-toggle="buttons">
    <h6 class="">Status</h6>
    {% for i in status_list %}
    <label class="shadow btn btn-outline-dark {% if i[0] == project.status %}active{% endif %}">
      {{ circle_icon(i[1]) }}
      <!--suppress HtmlUnknownAttribute -->
      <input type="radio" name="status" value="{{ i[0] }}" {% if i[0]== project.status %}checked="checked" {% endif %}>
      {{ i[0] }}
    </label>
    {% endfor %}
  </div>
  <div class="btn-group-toggle border rounded m-1 p-2 text-center" data-toggle="buttons" style="flex-wrap:wrap">
    <h6 class="">Tools Used</h6>
    {% for i in tools %}
    <label class="shadow btn btn-outline-dark my-1 {% if i.name in project.get_tools() %}active{% endif %}">
      {{ circle_icon(i.color) }}
      <!--suppress HtmlUnknownAttribute -->
      <input name="tools_used" type="checkbox" value="{{ i.id }}" {% if i.name in project.get_tools() %}checked="checked" {% endif %}>
      {{ i.name }}
    </label>
    {% endfor %}
  </div>
  <input type="url" name="github_url" class="form-control" value="{{ project.github_url }}">
  <button type="submit" class="btn btn-secondary w-100 my-2">Edit</button>
</form>
{% endmacro %}

<!--Add Tool Form-->
{% macro add_tool_form() %}
<form method="POST" action="{{ url_for('add_tool') }}" class="form-group">
  <input type="text" placeholder="Name" name="name" class="form-control my-2" autocomplete="off">
  <button type="submit" class="btn btn-success w-100 my-2">Add</button>
</form>
{% endmacro %}

<!--Modal-->
{% macro modal(id, header, class='') %}
<div class="modal {{ class }}" id="{{ id }}">
  <div class="modal-dialog modal-lg modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-body p-5">
        {{ title_div(header, class='display-4') }}
        {{ caller() }}
      </div>
    </div>
  </div>
</div>
{% endmacro %}

<!--Sort Projects Filter-->
{% macro sort_projects_filter(class='') %}
<div class="list-inline {{ class }}">
  <small>Sort by: </small>
  {% if order_by == "name" %}
  {{ unstyled_link('Start Date', href=url_for('projects', order_by='start_date desc'), class='badge badge-light mx-1') }}
  {{ unstyled_link('Status', href=url_for('projects', order_by='status'), class='badge badge-light mx-1') }}
  {% elif order_by == "start_date desc" %}
  {{ unstyled_link('Name', href=url_for('projects', order_by='name'), class='badge badge-light mx-1') }}
  {{ unstyled_link('Status', href=url_for('projects', order_by='status'), class='badge badge-light mx-1') }}
  {% elif order_by == "status" %}
  {{ unstyled_link('Name', href=url_for('projects', order_by='name'), class='badge badge-light mx-1') }}
  {{ unstyled_link('Start Date', href=url_for('projects', order_by='start_date desc'), class='badge badge-light mx-1') }}
  {% endif %}
</div>
{% endmacro %}