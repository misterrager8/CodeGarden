{% extends "base.html" %}
{% import "macros.html" as macros with context %}
{% block body %}
<title>{{ repo_.name }}</title>
<input id="repoPath" value="{{ repo_.path }}" style="display: none;">
<div class="pb-5 text-center">
	<div class="fs-1">{{ repo_.name }}</div>
	<div>
		<a href="{{ url_for('repos.repo', name=repo_.name) }}" class="btn btn-outline-primary"><i class="bi bi-arrow-clockwise"></i></a>
		<a onclick="copyPath()" class="btn btn-outline-secondary"><i id="copyIcon" class="bi bi-clipboard"></i></a>
	</div>
</div>
<div class="row">
	<div class="col-6">
		<ul class="nav nav-tabs">
			<li class="nav-item">
				<a class="nav-link active" data-bs-toggle="tab" data-bs-target="#status">Status</a>
			</li>
			<li class="nav-item">
				<a class="nav-link" data-bs-toggle="tab" data-bs-target="#log">Log</a>
			</li>
		</ul>
		<div class="tab-content font-monospace">
			<div class="tab-pane active p-5" id="status">
				<form class="input-group" method="POST" action="{{ url_for('repos.commit', name=repo_.name) }}">
					<label for="msg" class="input-group-text">git commit -am </label>
					<input required type="text" name="msg" autocomplete="off" class="form-control" id="msg">
					<button type="submit" class="btn btn-outline-secondary"><i class="bi bi-file-diff"></i></button>
				</form>
				<div style="white-space: pre-wrap;">{{ repo_.git(['git', 'status']) }}</div>
			</div>
			<div style="white-space: pre-wrap;" class="tab-pane p-5" id="log">{{ repo_.git(['git', 'log', '-5']) }}</div>
		</div>
	</div>
	<div class="col-6">
		<form class="input-group" method="POST" action="{{ url_for('todos.add_todo', name=repo_.name) }}">
			<label for="description" class="input-group-text">Add TODO: </label>
			<input required type="text" id="description" name="description" class="form-control" autocomplete="off">
			<button type="submit" class="btn btn-outline-success"><i class="bi bi-plus-lg"></i></button>
		</form>
		{% for i in repo_.get_todos() %}
		<div class="{% if i.done %}opacity-25{% endif %}">
			<form method="POST" action="{{ url_for('todos.edit_todo', name=repo_.name, idx=loop.index - 1) }}" class="input-group">
				<a class="btn" href="{{ url_for('todos.mark_todo', name=repo_.name, idx=loop.index - 1) }}"><i class="bi bi-check-lg text-{% if i.done %}success{% else %}secondary{% endif %}"></i></a>
				<input required type="text" name="description" autocomplete="off" class="form-control border-0 p-0" value="{{ i.description }}">
				<a class="btn text-danger" href="{{ url_for('todos.delete_todo', name=repo_.name, idx=loop.index - 1) }}"><i class="bi bi-x-lg"></i></a>
			</form>
		</div>
		{% endfor %}
	</div>
</div>
{% endblock %}