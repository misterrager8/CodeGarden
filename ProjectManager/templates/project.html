{% extends "base.html" %}
{% import "macros.html" as macros with context %}

{% block body %}
<title>{{ project_.name }}</title>
<a onclick="toggleDiv('editReadme')" class="bi bi-pen font-custom"> edit</a>
<div class="row mt-3">
    <div class="col" style="white-space: pre-wrap" id="preview">{{ project_.get_readme_as_md() | safe }}</div>
    <div class="col" style="display: none" id="editReadme" class="mt-3">{{ macros.readme_form(project_)}}</div>
</div>
<hr>
<span class="font-custom">git status</span>
<a onclick="gitStatus({{ project_.id }})" class="bi bi-arrow-clockwise"></a>
<div class="mt-3 font-monospace fst-italic">
    <div style="white-space: pre-wrap" id="refreshThis">{{ project_.git_status() }}</div>
</div>
<div class="mt-3">{{ macros.add_todo_form(project_) }}</div>
<span class="font-custom">{{ '%s undone' % project_.get_todos(filter_='not done').count() }}</span>
<div class="my-3">
    {% for i in project_.get_todos() %}
    {{ macros.todo_card(i) }}
    {% endfor %}
</div>
{% if project_.get_todos().count() > 0 %}<a class="btn-custom" href="{{ url_for('export_todos', id_=project_.id) }}">export todos</a>{% endif %}
{% endblock %}
