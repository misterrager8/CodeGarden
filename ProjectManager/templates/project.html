{% extends "base.html" %}
{% import "macros.html" as macros with context %}

{% block body %}
<title>{{ project_.name }}</title>
<a onclick="toggleDiv('editReadme')" class="bi bi-pen badge-custom"> edit readme</a>
<a onclick="copyPath()" class="bi bi-clipboard badge-custom" id="copyIcon"> copy path</a>
<input class="input-hidden" value="{{ project_.filepath }}" style="display: none" id="copyPath">
<div class="row mt-3">
    <div class="col" style="white-space: pre-wrap" id="preview">{{ project_.get_readme_as_md() | safe }}</div>
    <div class="col" style="display: none" id="editReadme" class="mt-3">{{ macros.readme_form(project_)}}</div>
</div>
<hr>

<span class="font-custom">git: </span>
<a onclick="gitCommand({{ project_.id }}, 'git status')" class="badge-custom">status</a>
<a onclick="gitCommand({{ project_.id }}, 'git --no-pager diff')" class="badge-custom">diff</a>
<a onclick="gitCommand({{ project_.id }}, 'git log -10')" class="badge-custom">log</a>
<a onclick="gitCommand({{ project_.id }}, 'git branch')" class="badge-custom">branch</a>
<div class="mt-3 font-monospace fst-italic">
    <div style="white-space: pre-wrap" id="refreshThis"></div>
</div>

<div class="mt-3">{{ macros.add_todo_form(project_) }}</div>
<span class="font-custom">{{ '%s undone' % project_.get_todos(filter_='not done').count() }}</span>
<div class="my-3">
    {% for i in project_.get_todos() %}
    {{ macros.todo_card(i) }}
    {% endfor %}
</div>
{% if project_.get_todos().count() > 0 %}<a class="btn-custom bi bi-file-earmark-arrow-down" onclick="exportTodos({{ project_.id }})" id="exportIcon"> export todos</a>{% endif %}
{% endblock %}
